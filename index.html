<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>David Pedrick's Contact Info</title>
  <meta name="description" content="Add my contact or share yours in one tap." />
  <meta name="theme-color" content="#0b0f19" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{--bg:#0b0f19;--card:#121826;--text:#e5e7eb;--muted:#9ca3af;--accent:#60a5fa}
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--text);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Inter,sans-serif}
    .wrap{max-width:680px;margin:0 auto;padding:24px}
    .card{background:var(--card);border:1px solid #1f2937;border-radius:18px;padding:22px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    h1{margin:.25em 0 0;font-size:1.65rem}
    .sub{color:var(--muted);margin:6px 0 6px}
  .contact{display:flex;flex-direction:column;gap:4px;margin-bottom:6px}
  .contact-link{color:var(--muted);font-size:.85rem;text-decoration:none;display:block}
    .grid{display:grid;gap:12px}
  .btn{display:flex;align-items:center;justify-content:center;gap:.5rem;border:1px solid #293241;background:#0f1522;color:var(--text);padding:14px 16px;border-radius:12px;text-decoration:none;cursor:pointer}
    .btn.primary{background:var(--accent);color:#0b0f19;border-color:transparent;font-weight:600}
  #btnShare{transition:transform .35s cubic-bezier(.2,.9,.2,1),background-color .18s ease,border-color .18s ease}
  .btn.ready{background:#34d399;color:#072;border-color:transparent}
  .btn.slide-in{transform:translateY(0);opacity:1}
    input,textarea{width:100%;padding:12px 14px;border-radius:12px;border:1px solid #253046;background:#0f1522;color:var(--text)}
    .row{display:grid;gap:12px;grid-template-columns:1fr 1fr}
    .muted{color:var(--muted);font-size:.9rem}
  .hide{display:none}
  /* collapsed/expanded animation for the contact form so it pushes the buttons down */
  .collapsed{max-height:0;overflow:hidden;transition:max-height .35s cubic-bezier(.2,.9,.2,1),padding .2s ease}
  .expanded{max-height:420px}
    footer{margin-top:18px;display:flex;justify-content:space-between;align-items:center;color:var(--muted);font-size:.85rem}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1 id="name">David Pedrick</h1>
      <div class="sub" id="subtitle">Ekotrope • Director of Core Energy Solutions</div>
      <div class="contact" id="contactInfo" aria-label="contact information">
        <a id="contactPhone" class="contact-link" href="#"></a>
        <a id="contactEmail" class="contact-link" href="#"></a>
        <a id="contactLocation" class="contact-link" href="#" target="_blank" rel="noopener"></a>
      </div>
      
      <div class="grid" id="buttonRow" style="margin-bottom:12px">
        <button class="btn primary" id="btnAdd">Save David's contact to your phone</button>
        <button class="btn" id="btnShare">Email me your contact info</button>
      </div>

  <form id="form" class="grid collapsed" novalidate>
        <div class="row">
          <input name="first" placeholder="Your first name" autocomplete="given-name" required />
          <input name="last" placeholder="last name" autocomplete="family-name" required />
        </div>
    <input name="phone" placeholder="Phone" autocomplete="tel" required />
    <input name="website" placeholder="Website (optional)" autocomplete="url" />
  <textarea name="note" rows="3" placeholder="Note (optional)"></textarea>
  <!-- Using the top "Email me your contact info" button to submit. Removed internal submit button. -->
        <div id="status" class="muted"></div>
      </form>

      <footer>
        <span id="caps" class="muted"></span>
        <a id="emailMe" class="muted" href="#"></a>
      </footer>
    </div>
  </div>

  <script>
  // --- CONFIGURE YOUR DETAILS HERE ---
  const MY = {
    fullName: "David Pedrick",           // Update as needed
    org: "Ekotrope",
    title: "Director of Core Energy Solutions",
    phone: "+1-617-286-4609",
    email: "david@ekotrope.com",
    address: "Boston, MA, USA",
    city: "Boston",
    state: "MA",
    website: "https://www.ekotrope.com"       // optional, used in vCard URL field
  };
  // -----------------------------------

  // Inject name/subtitle
  document.getElementById('name').textContent = MY.fullName;
  document.getElementById('subtitle').textContent = `${MY.org} • ${MY.title}`;
  // Set fallback href for the Email link (helps when JS is disabled or as a direct link)
  const emailMeLink = document.getElementById('emailMe');
  if (emailMeLink) emailMeLink.href = `mailto:${MY.email}`;

  // Populate contact info block under the title
  const contactPhone = document.getElementById('contactPhone');
  const contactEmail = document.getElementById('contactEmail');
  const contactLocation = document.getElementById('contactLocation');
  if (contactPhone) {
    contactPhone.href = `tel:${MY.phone}`;
    contactPhone.textContent = MY.phone;
  }
  if (contactEmail) {
    contactEmail.href = `mailto:${MY.email}`;
    contactEmail.textContent = MY.email;
  }
  if (contactLocation) {
    // Prefer explicit city/state if present; otherwise fall back to address.
    let locText = '';
    let locQuery = '';
    if (MY.city && MY.state) {
      locText = `${MY.city}, ${MY.state}`;
      locQuery = encodeURIComponent(`${MY.city}, ${MY.state}`);
    } else if (MY.address) {
      locText = MY.address;
      locQuery = encodeURIComponent(MY.address);
    }
    contactLocation.href = locQuery ? `https://www.google.com/maps/search/?api=1&query=${locQuery}` : '#';
    contactLocation.textContent = locText;
  }

  // Build a vCard 3.0 string
  function buildVCard() {
    const parts = MY.fullName.trim().split(/\s+/);
    const last = parts.pop() || "";
    const first = parts.join(" ");
    const now = new Date().toISOString().replace(/[-:]/g,"").split(".")[0] + "Z";
    const esc = s => (s||"").replaceAll(",","\\,");
    const lines = [
      "BEGIN:VCARD",
      "VERSION:3.0",
      `N:${esc(last)};${esc(first)};;;`,
      `FN:${esc(MY.fullName)}`,
      `ORG:${esc(MY.org)}`,
      `TITLE:${esc(MY.title)}`,
      `TEL;TYPE=CELL:${MY.phone}`,
      `EMAIL;TYPE=INTERNET:${MY.email}`,
      `ADR;TYPE=WORK:;;${esc(MY.address)};;;`,
      `URL:${MY.website}`,
      `REV:${now}`,
      "END:VCARD"
    ];
    return lines.join("\r\n");
  }

  function downloadVCard() {
    const blob = new Blob([buildVCard()], { type: 'text/vcard;charset=utf-8' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = `${MY.fullName.replace(/\s+/g,'_')}.vcf`;
    document.body.appendChild(a);
    a.click();
    a.remove();
    setTimeout(()=>URL.revokeObjectURL(url), 500);
  }

  function openMailto(bodyText, subjectText) {
    // Build a sensible default and always encode subject/body.
    const subject = subjectText || 'Great to meet you';
    // Default to the requested template (blank custom note/name/phone/website when no data provided)
    const defaultBody = `Here is my contact info.\n\n${''}\n\nFrom,\n${''}\n${''}\n${''}`;
    const body = bodyText || defaultBody;
    // Use unencoded recipient (some clients expect the raw address) and encode subject/body
    const mailto = `mailto:${MY.email}?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
    location.href = mailto;
  }

  // Buttons
  document.getElementById('btnAdd').addEventListener('click', downloadVCard);
  document.getElementById('emailMe').addEventListener('click', (e)=>{ e.preventDefault(); openMailto(); });

  // Share Your Contact (no backend):
  // 1) If Contact Picker API is available (Chrome/Android + some Chromium), let the user pick a contact and email it to you prefilled.
  // 2) Otherwise, reveal a tiny form; on submit, open a prefilled mailto: to your inbox.
  const capsEl = document.getElementById('caps');
  const form = document.getElementById('form');
  const statusEl = document.getElementById('status');
  const btnShare = document.getElementById('btnShare');
  // Helper: check required fields
  function formIsValid() {
    const f = form.querySelector('[name="first"]');
    const l = form.querySelector('[name="last"]');
    const p = form.querySelector('[name="phone"]');
    return f && l && p && f.value.trim() !== '' && l.value.trim() !== '' && p.value.trim() !== '';
  }

  function updateShareButtonState() {
    if (formIsValid()) {
      btnShare.classList.add('ready');
      btnShare.textContent = 'Send Email';
    } else {
      btnShare.classList.remove('ready');
      btnShare.textContent = 'Email me your contact info';
    }
  }

  // show form with slide-down effect
  let formVisible = false;
  btnShare.addEventListener('click', (e) => {
    e.preventDefault();
    if (!formVisible) {
      // reveal form and allow CSS max-height to animate layout
      form.classList.remove('collapsed');
      form.classList.add('expanded');
      // move the share button after the form in the DOM so it appears under it
      const buttonRow = document.getElementById('buttonRow');
      const parent = buttonRow.parentNode;
      parent.insertBefore(btnShare, form.nextSibling);
      // prepare animation
      btnShare.classList.add('slide-in');
      formVisible = true;
      // attach input listeners to validate
      form.querySelectorAll('input,textarea').forEach(inp => inp.addEventListener('input', updateShareButtonState));
      updateShareButtonState();
      return;
    }
    // If form visible and valid, send mail
  if (formVisible && formIsValid()) {
      const fd = new FormData(form);
      const customNote = fd.get('note') || '';
      const website = fd.get('website') || '';
      const msg = `Nice to meet you. Here is my contact info.\n\n${customNote}\n\nFrom,\n${fd.get('first')} ${fd.get('last')}\n${fd.get('phone')||''}\n${website}`;
      location.href = `mailto:${MY.email}?subject=${encodeURIComponent('Nice to meet you')}&body=${encodeURIComponent(msg)}`;
      
      // collapse the form after sending
      form.classList.remove('expanded');
      form.classList.add('collapsed');
      formVisible = false;
  // move the share button back to the original button row and remove animation class
  const buttonRow = document.getElementById('buttonRow');
  buttonRow.appendChild(btnShare);
  btnShare.classList.remove('slide-in');
      updateShareButtonState();
    } else {
      // not valid yet — focus first missing field
      const f = form.querySelector('[name="first"]');
      const l = form.querySelector('[name="last"]');
      if (f && f.value.trim() === '') f.focus();
      else if (l && l.value.trim() === '') l.focus();
    }
  });
  </script>
</body>
</html>

